# AI 프로젝트 - Mutee

## 목적
영상 대본 기반 자동 연령분류 및 비속어 필터링 서비스

## 1. 데이터셋 준비
- 연령 분류: 12세 이하, 15세, 19세
- 판단 기준: 폭력성 기반 장르
- 취득 방식: 넷플릭스 영상물 자막 추출

## 2. 데이터셋 전처리
- 댓글 형식과 대본 형식의 차이점을 해결하기 위한 대본 형식의 데이터 전처리
- 대본 데이터에서 한국어 대사 추출
- 긍/부정 댓글 데이터셋으로 Fine-tune된 KcELECTRA 모델을 사용하여 한국어 대본 각 문장별 평가
- 댓글 데이터: 대략 10000 문장
- 해당 데이터는 0~1 사이의 값으로 욕설, 악의적 표현 정도를 판단
- 산출된 대본 레이블에서 잘못 평가된 영역을 사람이 수정 

## 3. 데이터셋 학습 방법
- KcELECTRA 모델을 전처리된 대본 기반 데이터를 활용하여 Fine-tuning 
- 대본 데이터: 112288문장
- 실제 학습 데이터 2만 문장 
- 60000 ~ 70000 + 102288 ~ 112288번째 문장 학습

## 4. 평가 방식
- Held-out 데이터셋을 사용하여 모델 평가
- N~N+4의 3개 문장의 평균 비속어 점수의 평균 산출
- 데이터 후처리에 사용되는 문장의 개수를 Hyperparameter로 사용하여 조절
- 데이터의 정확도를 향상시키기 위해 Held-out 데이터셋을 바탕으로 최적의 Hyperparameter 산출 

## 5. 비속어 필터링
- 비속어 점수가 일정 수준 이상인 문장의 단어 필터링
- 현재 문서에 존재하는 욕설, 비속어 표현의 개수 도출
- 필터링 이후 변경된 연령 분류 표기

## 6. 시각화 및 발표
- 생성된 데이터의 정확도와 분산 등의 데이터 시각화
- 시각화한 데이터를 Web 환경으로 제공하는 환경 구성

## 7. 기능적 구현
- xlsx 파일로 구성된 대본 파일을 입력

출력 정보
1. 주어진 대본의 연령 분류 표시
2. 주어진 대본에서 어느 부분이 공격성을 나타내는지 그래프로 표시
3. 공격성이 들어나는 대본의 시간대 및 대사 출력
4. (해당 부분을 제거하였을 시 변화하는 연령 분류 표시)

## 시행착오
초기 구성 단계에서 STT or Wav2Vec모델을 직접 사용하여 영상에서 음성 데이터를 추출하여 이를 사용하려 했지만, 모델들의 정확도의 이슈가 발생
- 넷플릭스에서 제공하는 대본을 추출하여 사용하는 것으로 변경

댓글 데이터를 학습한 모델로 평가한 대본 레이블만을 이용하여 연령분류를 하려고 했지만, 댓글 형식과 대본 형식의 데이터 차이 + 많지 않은 댓글 데이터로 인해 잘못된 레이블 발생
- 댓글 기반으로 학습한 모델을 사용하여 대본 데이처 1차 레이블링 이후 잘못 레이블링한 대본 문장을 사람이 수정하여 새로운 train-set 구성 

11만여개의 대본을 동시에 학습하려고 하였지만, 특정 구간의 데이터를 학습하려고 할 때 오류 발생, 부부의 세계 약 8000여 문장,
92000~ 100000째 문장에서 오류 발생 
- 데이터의 수를 줄여서 학습하였을 때 정상적으로 진행된 것을 확인할 수 있었음

## 데이터 결과 여부
- 0 ~ 92000 + 102288 ~ 112288 : 모든 레이블이 동일함
- 하트가 빛나는 순간 + 나의 해방일지 + 수리남 : 모든 레이블 동일함
- 50000 ~ 80000 : 모든 레이블 동일함
- 60000 ~ 80000 : 모든 레이블 동일함
- 70000 ~ 80000 + 102288 ~ 112288 : 데이터에서 오류 발생
- 60000 ~ 70000 + 102288 ~ 112288 : 정상적인 결과(0.96),
- 102288 ~ 112288 : 정상적인 결과(0.91)
- 70000 ~ 90000 : 모든 레이블 동일
- 70000 ~ 80000 : 정상적인 결과(0.92)
- 80000 ~ 90000 : 정상적인 결과 
- 40000 ~ 50000 + 80000 ~ 90000 + 102288 ~ 112288 : 모든 레이블 동일함


## 역할 분담
- 데이터 추출: 황서진
- 모델 기반 데이터 전처리: 배한나
- 대본 데이터 레이블링: 12세 미만-김민석, 15세-김두현, 19세-배한나
- 모델 학습: 김두현, 배한나
- 모델 후처리: 김두현
- 데이터 시각화 및 프론트엔드: 김민석
- 발표 자료 구성 및 발표: 황서진
